(()=>{"use strict";var e,t,n={87(e){e.exports=window.wp.element}},o={};function r(e){var t=o[e];if(void 0!==t)return t.exports;var a=o[e]={exports:{}};return n[e](a,a.exports,r),a.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,r.t=function(n,o){if(1&o&&(n=this(n)),8&o)return n;if("object"==typeof n&&n){if(4&o&&n.__esModule)return n;if(16&o&&"function"==typeof n.then)return n}var a=Object.create(null);r.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&o&&n;("object"==typeof l||"function"==typeof l)&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(e=>i[e]=()=>n[e]);return i.default=()=>n,r.d(a,i),a},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};const a=window.React;var i=r(87);const l=window.wp.components,c=window.wp.primitives,d=(0,a.createElement)(c.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,a.createElement)(c.Path,{d:"m19 7-3-3-8.5 8.5-1 4 4-1L19 7Zm-7 11.5H5V20h7v-1.5Z"}));function s({onClick:e}){return(0,a.createElement)(l.Button,{className:"anybody-editing-edit-button",icon:d,label:"Edit this block",onClick:e,variant:"primary",size:"small"})}const u=window.wp.blockEditor,m=window.wp.blocks,y=window.wp.apiFetch;var p=r.n(y);const{restUrl:b,postId:f}=window.anybodyEditingData;function v({blockIndex:e,blockName:t,onSave:n,onCancel:o}){const[r,c]=(0,i.useState)(!1),[d,s]=(0,i.useState)(null),y=window.anybodyEditingData.post.content,b=(0,i.useMemo)(()=>(0,m.parse)(y),[y]),[v,w]=(0,i.useState)(()=>{const t=b.filter(e=>e.name);return t[e]?[t[e]]:[]});return(0,a.createElement)("div",{className:"anybody-editing-editor-wrapper"},(0,a.createElement)(u.BlockEditorProvider,{value:v,onInput:e=>w(e),onChange:e=>w(e)},(0,a.createElement)(u.WritingFlow,null,(0,a.createElement)(u.ObserveTyping,null,(0,a.createElement)(u.BlockList,null))),(0,a.createElement)(l.Popover.Slot,null)),d&&(0,a.createElement)("div",{className:"anybody-editing-error"},d),(0,a.createElement)("div",{className:"anybody-editing-editor-actions"},(0,a.createElement)(l.Button,{variant:"tertiary",onClick:o,disabled:r},"Cancel"),(0,a.createElement)(l.Button,{variant:"primary",onClick:async()=>{c(!0),s(null);try{const t=b.filter(e=>e.name);t[e]=v[0];let o=[],r=0;for(const e of b)e.name?(o.push(t[r]),r++):o.push(e);const a=(0,m.serialize)(o);await async function(e){return p()({path:`anybody-editing/v1/posts/${f}`,method:"POST",data:e})}({content:a}),n()}catch(e){s(e.message||"Failed to save. Please try again."),c(!1)}},disabled:r},r?(0,a.createElement)(l.Spinner,null):"Save")))}function w(){const[e,t]=(0,i.useState)(null),[n,o]=(0,i.useState)([]);return(0,i.useEffect)(()=>{const e=document.querySelectorAll(".anybody-editing-block"),t=Array.from(e).map((e,t)=>({element:e,index:t,name:e.dataset.blockName}));o(t),t.forEach(e=>{const t=document.createElement("div");t.className="anybody-editing-button-container",e.element.appendChild(t)})},[]),(0,i.useEffect)(()=>{n.forEach(n=>{const o=n.element.querySelector(".anybody-editing-button-container");o&&e!==n.index&&Promise.resolve().then(r.t.bind(r,87,23)).then(({render:e})=>{e((0,a.createElement)(s,{onClick:()=>t(n.index)}),o)})})},[n,e]),(0,i.useEffect)(()=>{if(null===e)return;const o=n[e];if(!o)return;o.element.querySelector(":not(.anybody-editing-button-container):not(.anybody-editing-editor-container)");let i=o.element.querySelector(".anybody-editing-editor-container");return i||(i=document.createElement("div"),i.className="anybody-editing-editor-container",o.element.appendChild(i)),Promise.resolve().then(r.t.bind(r,87,23)).then(({render:n})=>{n((0,a.createElement)(v,{blockIndex:e,blockName:o.name,onSave:()=>{t(null),window.location.reload()},onCancel:()=>t(null)}),i)}),()=>{i&&(i.innerHTML="")}},[e,n]),null}function E(){const e=document.createElement("div");e.id="anybody-editing-root",document.body.appendChild(e),(0,i.render)((0,a.createElement)(w,null),e)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",E):E()})();